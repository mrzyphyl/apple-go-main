{"ast":null,"code":"import _classCallCheck from \"@babel/runtime/helpers/classCallCheck\";\nimport _createClass from \"@babel/runtime/helpers/createClass\";\nfunction _createForOfIteratorHelperLoose(o, allowArrayLike) { var it = typeof Symbol !== \"undefined\" && o[Symbol.iterator] || o[\"@@iterator\"]; if (it) return (it = it.call(o)).next.bind(it); if (Array.isArray(o) || (it = _unsupportedIterableToArray(o)) || allowArrayLike && o && typeof o.length === \"number\") { if (it) o = it; var i = 0; return function () { if (i >= o.length) return { done: true }; return { done: false, value: o[i++] }; }; } throw new TypeError(\"Invalid attempt to iterate non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\"); }\nfunction _unsupportedIterableToArray(o, minLen) { if (!o) return; if (typeof o === \"string\") return _arrayLikeToArray(o, minLen); var n = Object.prototype.toString.call(o).slice(8, -1); if (n === \"Object\" && o.constructor) n = o.constructor.name; if (n === \"Map\" || n === \"Set\") return Array.from(o); if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen); }\nfunction _arrayLikeToArray(arr, len) { if (len == null || len > arr.length) len = arr.length; for (var i = 0, arr2 = new Array(len); i < len; i++) arr2[i] = arr[i]; return arr2; }\nfunction _defineProperty(obj, key, value) {\n  key = _toPropertyKey(key);\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n  return obj;\n}\nfunction _toPropertyKey(arg) {\n  var key = _toPrimitive(arg, \"string\");\n  return typeof key === \"symbol\" ? key : String(key);\n}\nfunction _toPrimitive(input, hint) {\n  if (typeof input !== \"object\" || input === null) return input;\n  var prim = input[Symbol.toPrimitive];\n  if (prim !== undefined) {\n    var res = prim.call(input, hint || \"default\");\n    if (typeof res !== \"object\") return res;\n    throw new TypeError(\"@@toPrimitive must return a primitive value.\");\n  }\n  return (hint === \"string\" ? String : Number)(input);\n}\nimport { runOnUIImmediately } from \"../../threads\";\nimport { registerEventHandler, unregisterEventHandler } from \"../../core\";\nimport Platform from \"react-native-web/dist/exports/Platform\";\nexport var ProgressTransitionManager = function () {\n  function ProgressTransitionManager() {\n    _classCallCheck(this, ProgressTransitionManager);\n    _defineProperty(this, \"_sharedElementCount\", 0);\n    _defineProperty(this, \"_eventHandler\", {\n      isRegistered: false,\n      onTransitionProgress: -1,\n      onAppear: -1,\n      onDisappear: -1,\n      onSwipeDismiss: -1\n    });\n  }\n  _createClass(ProgressTransitionManager, [{\n    key: \"addProgressAnimation\",\n    value: function addProgressAnimation(viewTag, progressAnimation) {\n      runOnUIImmediately(function () {\n        'worklet';\n\n        global.ProgressTransitionRegister.addProgressAnimation(viewTag, progressAnimation);\n      })();\n      this.registerEventHandlers();\n    }\n  }, {\n    key: \"removeProgressAnimation\",\n    value: function removeProgressAnimation(viewTag) {\n      this.unregisterEventHandlers();\n      runOnUIImmediately(function () {\n        'worklet';\n\n        global.ProgressTransitionRegister.removeProgressAnimation(viewTag);\n      })();\n    }\n  }, {\n    key: \"registerEventHandlers\",\n    value: function registerEventHandlers() {\n      this._sharedElementCount++;\n      var eventHandler = this._eventHandler;\n      if (!eventHandler.isRegistered) {\n        eventHandler.isRegistered = true;\n        var eventPrefix = Platform.OS === 'android' ? 'on' : 'top';\n        var lastProgressValue = -1;\n        eventHandler.onTransitionProgress = registerEventHandler(function (event) {\n          'worklet';\n\n          var progress = event.progress;\n          if (progress === lastProgressValue) {\n            return;\n          }\n          lastProgressValue = progress;\n          global.ProgressTransitionRegister.frame(progress);\n        }, eventPrefix + 'TransitionProgress');\n        eventHandler.onAppear = registerEventHandler(function () {\n          'worklet';\n\n          global.ProgressTransitionRegister.onTransitionEnd();\n        }, eventPrefix + 'Appear');\n        if (Platform.OS === 'android') {\n          eventHandler.onDisappear = registerEventHandler(function () {\n            'worklet';\n\n            global.ProgressTransitionRegister.onAndroidFinishTransitioning();\n          }, 'onFinishTransitioning');\n        } else if (Platform.OS === 'ios') {\n          eventHandler.onDisappear = registerEventHandler(function () {\n            'worklet';\n\n            global.ProgressTransitionRegister.onTransitionEnd(true);\n          }, 'topDisappear');\n          eventHandler.onSwipeDismiss = registerEventHandler(function () {\n            'worklet';\n\n            global.ProgressTransitionRegister.onTransitionEnd();\n          }, 'topGestureCancel');\n        }\n      }\n    }\n  }, {\n    key: \"unregisterEventHandlers\",\n    value: function unregisterEventHandlers() {\n      this._sharedElementCount--;\n      if (this._sharedElementCount === 0) {\n        var eventHandler = this._eventHandler;\n        eventHandler.isRegistered = false;\n        if (eventHandler.onTransitionProgress !== -1) {\n          unregisterEventHandler(eventHandler.onTransitionProgress);\n          eventHandler.onTransitionProgress = -1;\n        }\n        if (eventHandler.onAppear !== -1) {\n          unregisterEventHandler(eventHandler.onAppear);\n          eventHandler.onAppear = -1;\n        }\n        if (eventHandler.onDisappear !== -1) {\n          unregisterEventHandler(eventHandler.onDisappear);\n          eventHandler.onDisappear = -1;\n        }\n        if (eventHandler.onSwipeDismiss !== -1) {\n          unregisterEventHandler(eventHandler.onSwipeDismiss);\n          eventHandler.onSwipeDismiss = -1;\n        }\n      }\n    }\n  }]);\n  return ProgressTransitionManager;\n}();\nfunction createProgressTransitionRegister() {\n  'worklet';\n\n  var progressAnimations = new Map();\n  var snapshots = new Map();\n  var currentTransitions = new Set();\n  var toRemove = new Set();\n  var progressTransitionManager = {\n    addProgressAnimation: function addProgressAnimation(viewTag, progressAnimation) {\n      progressAnimations.set(viewTag, progressAnimation);\n    },\n    removeProgressAnimation: function removeProgressAnimation(viewTag) {\n      if (progressAnimations.size > 1) {\n        toRemove.add(viewTag);\n      } else {\n        progressAnimations.delete(viewTag);\n      }\n    },\n    onTransitionStart: function onTransitionStart(viewTag, snapshot) {\n      snapshots.set(viewTag, snapshot);\n      currentTransitions.add(viewTag);\n      progressTransitionManager.frame(0);\n    },\n    frame: function frame(progress) {\n      for (var _iterator = _createForOfIteratorHelperLoose(currentTransitions), _step; !(_step = _iterator()).done;) {\n        var viewTag = _step.value;\n        var progressAnimation = progressAnimations.get(viewTag);\n        var snapshot = snapshots.get(viewTag);\n        progressAnimation(viewTag, snapshot, progress);\n      }\n    },\n    onAndroidFinishTransitioning: function onAndroidFinishTransitioning() {\n      if (toRemove.size > 0) {\n        progressTransitionManager.onTransitionEnd();\n      }\n    },\n    onTransitionEnd: function onTransitionEnd() {\n      var removeViews = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : false;\n      for (var _iterator2 = _createForOfIteratorHelperLoose(currentTransitions), _step2; !(_step2 = _iterator2()).done;) {\n        var _viewTag = _step2.value;\n        _notifyAboutEnd(_viewTag, removeViews);\n      }\n      currentTransitions.clear();\n      snapshots.clear();\n      if (toRemove.size > 0) {\n        for (var _iterator3 = _createForOfIteratorHelperLoose(toRemove), _step3; !(_step3 = _iterator3()).done;) {\n          var viewTag = _step3.value;\n          progressAnimations.delete(viewTag);\n        }\n        toRemove.clear();\n      }\n    }\n  };\n  return progressTransitionManager;\n}\nrunOnUIImmediately(function () {\n  'worklet';\n\n  global.ProgressTransitionRegister = createProgressTransitionRegister();\n})();","map":{"version":3,"sources":["C:\\Users\\Asus\\Desktop\\sirFrancis-main\\node_modules\\react-native-reanimated\\lib\\module\\reanimated2\\layoutReanimation\\sharedTransitions\\ProgressTransitionManager.ts"],"names":["runOnUIImmediately","registerEventHandler","unregisterEventHandler","ProgressTransitionManager","constructor","_defineProperty","isRegistered","onTransitionProgress","onAppear","onDisappear","onSwipeDismiss","addProgressAnimation","viewTag","progressAnimation","global","ProgressTransitionRegister","registerEventHandlers","removeProgressAnimation","unregisterEventHandlers","_sharedElementCount","eventHandler","_eventHandler","eventPrefix","Platform","OS","lastProgressValue","event","progress","frame","onTransitionEnd","onAndroidFinishTransitioning","createProgressTransitionRegister","progressAnimations","Map","snapshots","currentTransitions","Set","toRemove","progressTransitionManager","set","size","add","delete","onTransitionStart","snapshot","get","removeViews","_notifyAboutEnd","clear"],"mappings":"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","sourcesContent":["import { runOnUIImmediately } from '../../threads';\nimport type { ProgressAnimation } from '../animationBuilder/commonTypes';\nimport { registerEventHandler, unregisterEventHandler } from '../../core';\nimport { Platform } from 'react-native';\n\ntype TransitionProgressEvent = {\n  closing: number;\n  goingForward: number;\n  eventName: string;\n  progress: number;\n  target: number;\n};\n\nexport class ProgressTransitionManager {\n  private _sharedElementCount = 0;\n  private _eventHandler = {\n    isRegistered: false,\n    onTransitionProgress: -1,\n    onAppear: -1,\n    onDisappear: -1,\n    onSwipeDismiss: -1,\n  };\n\n  public addProgressAnimation(\n    viewTag: number,\n    progressAnimation: ProgressAnimation\n  ) {\n    runOnUIImmediately(() => {\n      'worklet';\n      global.ProgressTransitionRegister.addProgressAnimation(\n        viewTag,\n        progressAnimation\n      );\n    })();\n    this.registerEventHandlers();\n  }\n\n  public removeProgressAnimation(viewTag: number) {\n    this.unregisterEventHandlers();\n    runOnUIImmediately(() => {\n      'worklet';\n      global.ProgressTransitionRegister.removeProgressAnimation(viewTag);\n    })();\n  }\n\n  private registerEventHandlers() {\n    this._sharedElementCount++;\n    const eventHandler = this._eventHandler;\n    if (!eventHandler.isRegistered) {\n      eventHandler.isRegistered = true;\n      const eventPrefix = Platform.OS === 'android' ? 'on' : 'top';\n      let lastProgressValue = -1;\n      eventHandler.onTransitionProgress = registerEventHandler(\n        (event: TransitionProgressEvent) => {\n          'worklet';\n          const progress = event.progress;\n          if (progress === lastProgressValue) {\n            // During screen transition, handler receives two events with the same progress\n            // value for both screens, but for modals, there is only one event. To optimize\n            // performance and avoid unnecessary worklet calls, let's skip the second event.\n            return;\n          }\n          lastProgressValue = progress;\n          global.ProgressTransitionRegister.frame(progress);\n        },\n        eventPrefix + 'TransitionProgress'\n      );\n      eventHandler.onAppear = registerEventHandler(() => {\n        'worklet';\n        global.ProgressTransitionRegister.onTransitionEnd();\n      }, eventPrefix + 'Appear');\n\n      if (Platform.OS === 'android') {\n        // onFinishTransitioning event is available only on Android and\n        // is used to handle closing modals\n        eventHandler.onDisappear = registerEventHandler(() => {\n          'worklet';\n          global.ProgressTransitionRegister.onAndroidFinishTransitioning();\n        }, 'onFinishTransitioning');\n      } else if (Platform.OS === 'ios') {\n        // topDisappear event is required to handle closing modals on iOS\n        eventHandler.onDisappear = registerEventHandler(() => {\n          'worklet';\n          global.ProgressTransitionRegister.onTransitionEnd(true);\n        }, 'topDisappear');\n        eventHandler.onSwipeDismiss = registerEventHandler(() => {\n          'worklet';\n          global.ProgressTransitionRegister.onTransitionEnd();\n        }, 'topGestureCancel');\n      }\n    }\n  }\n\n  private unregisterEventHandlers(): void {\n    this._sharedElementCount--;\n    if (this._sharedElementCount === 0) {\n      const eventHandler = this._eventHandler;\n      eventHandler.isRegistered = false;\n      if (eventHandler.onTransitionProgress !== -1) {\n        unregisterEventHandler(eventHandler.onTransitionProgress);\n        eventHandler.onTransitionProgress = -1;\n      }\n      if (eventHandler.onAppear !== -1) {\n        unregisterEventHandler(eventHandler.onAppear);\n        eventHandler.onAppear = -1;\n      }\n      if (eventHandler.onDisappear !== -1) {\n        unregisterEventHandler(eventHandler.onDisappear);\n        eventHandler.onDisappear = -1;\n      }\n      if (eventHandler.onSwipeDismiss !== -1) {\n        unregisterEventHandler(eventHandler.onSwipeDismiss);\n        eventHandler.onSwipeDismiss = -1;\n      }\n    }\n  }\n}\n\nfunction createProgressTransitionRegister() {\n  'worklet';\n  const progressAnimations = new Map<number, ProgressAnimation>();\n  const snapshots = new Map<number, any>();\n  const currentTransitions = new Set<number>();\n  const toRemove = new Set<number>();\n\n  const progressTransitionManager = {\n    addProgressAnimation: (\n      viewTag: number,\n      progressAnimation: ProgressAnimation\n    ) => {\n      progressAnimations.set(viewTag, progressAnimation);\n    },\n    removeProgressAnimation: (viewTag: number) => {\n      if (progressAnimations.size > 1) {\n        // Remove the animation config after the transition is finished\n        toRemove.add(viewTag);\n      } else {\n        progressAnimations.delete(viewTag);\n      }\n    },\n    onTransitionStart: (viewTag: number, snapshot: any) => {\n      snapshots.set(viewTag, snapshot);\n      currentTransitions.add(viewTag);\n      // set initial style for re-parented components\n      progressTransitionManager.frame(0);\n    },\n    frame: (progress: number) => {\n      for (const viewTag of currentTransitions) {\n        const progressAnimation = progressAnimations.get(viewTag);\n        const snapshot = snapshots.get(viewTag);\n        progressAnimation!(viewTag, snapshot, progress);\n      }\n    },\n    onAndroidFinishTransitioning: () => {\n      if (toRemove.size > 0) {\n        // it should be ran only on modal closing\n        progressTransitionManager.onTransitionEnd();\n      }\n    },\n    onTransitionEnd: (removeViews = false) => {\n      for (const viewTag of currentTransitions) {\n        _notifyAboutEnd(viewTag, removeViews);\n      }\n      currentTransitions.clear();\n      snapshots.clear();\n      if (toRemove.size > 0) {\n        for (const viewTag of toRemove) {\n          progressAnimations.delete(viewTag);\n        }\n        toRemove.clear();\n      }\n    },\n  };\n  return progressTransitionManager;\n}\n\nrunOnUIImmediately(() => {\n  'worklet';\n  global.ProgressTransitionRegister = createProgressTransitionRegister();\n})();\n\nexport type ProgressTransitionRegister = ReturnType<\n  typeof createProgressTransitionRegister\n>;\n"]},"metadata":{},"sourceType":"module","externalDependencies":[]}